# WTurbo CLI

WTurboã¯ã€Git worktreeã¨Docker Composeã‚’ä½¿ç”¨ã—ã¦é–‹ç™ºç’°å¢ƒã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã™ã‚‹CLIãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## æ¦‚è¦

WTurboã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã®ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼š

- Git worktreeã‚’ä½¿ç”¨ã—ãŸãƒ–ãƒ©ãƒ³ãƒå˜ä½ã®ç‹¬ç«‹ã—ãŸé–‹ç™ºç’°å¢ƒã®ä½œæˆ
- gitignoreã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.envç­‰ï¼‰ã®worktreeã¸ã®è‡ªå‹•ã‚³ãƒ”ãƒ¼
- worktreeä½œæˆå¾Œ/å‰Šé™¤å‰ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆè‡ªå‹•å®Ÿè¡Œ
- ç’°å¢ƒå¤‰æ•°ã®è‡ªå‹•èª¿æ•´ï¼ˆãƒãƒ¼ãƒˆç•ªå·ã®é‡è¤‡å›é¿ãªã©ï¼‰
- é–‹ç™ºç’°å¢ƒã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªã¨ç®¡ç†

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install -g wturbo
```

## è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `wturbo.yaml` ã¾ãŸã¯ `wturbo.yml` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š

```yaml
# ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒï¼ˆé€šå¸¸ã¯ main ã¾ãŸã¯ masterï¼‰
base_branch: main

# Docker Composeãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
docker_compose_file: ./docker-compose.yml

# ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æŒ‡å®š
# gitignoreã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚worktreeã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã™
copy_files:
  - .env
  - .claude
  - .serena

# worktreeä½œæˆå¾Œã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
start_command: ./start-dev.sh

# worktreeå‰Šé™¤æ™‚ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰
end_command: ./stop-dev.sh

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
env:
  # ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆ
  file:
    - .env
    - .env.local

  # ç’°å¢ƒå¤‰æ•°ã®èª¿æ•´è¨­å®š
  # æ•°å€¤: ãƒãƒ¼ãƒˆç•ªå·ã«ãã®å€¤ã‚’åŠ ç®—
  # æ–‡å­—åˆ—: ãã®å€¤ã§ç½®æ›
  # null: å¤‰æ•°ã‚’å‰Šé™¤
  adjust:
    APP_PORT: 1000
    DB_PORT: 1000
```

## ã‚³ãƒãƒ³ãƒ‰

### `wturbo create <branch>`

æ–°ã—ã„worktreeã‚’ä½œæˆã—ã¾ã™ï¼š

```bash
wturbo create feature/new-feature
```

å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼š
1. Git worktreeã‚’ä½œæˆ
2. `copy_files`ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚³ãƒ”ãƒ¼
3. `start_command`ã‚’å®Ÿè¡Œï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼š
- `-p, --path <path>` - worktreeã®ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¹ã‚’æŒ‡å®š

### `wturbo remove <branch>`

worktreeã‚’å‰Šé™¤ã—ã¾ã™ï¼š

```bash
wturbo remove feature/new-feature
```

å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼š
1. `end_command`ã‚’å®Ÿè¡Œï¼ˆè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
2. Git worktreeã‚’å‰Šé™¤

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼š
- `-f, --force` - æœªã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ãŒã‚ã£ã¦ã‚‚å¼·åˆ¶å‰Šé™¤

### `wturbo status`

ç¾åœ¨ã®é–‹ç™ºç’°å¢ƒã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤ºã—ã¾ã™ï¼š

```bash
wturbo status
```

å‡ºåŠ›ä¾‹ï¼š
```
ğŸ“¦ Docker Containers (2 running)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name        â”‚ Image          â”‚ Status       â”‚ Ports           â”‚ Networks    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ myapp_web   â”‚ nginx:latest   â”‚ Up 2 hours   â”‚ 0.0.0.0:3000â†’80 â”‚ myapp_net   â”‚
â”‚ myapp_db    â”‚ postgres:13    â”‚ Up 2 hours   â”‚ 5432/tcp        â”‚ myapp_net   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŒ¿ Git Worktrees (3 total)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Path                        â”‚ Branch      â”‚ HEAD             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /project                    â”‚ main        â”‚ a1b2c3d          â”‚
â”‚ /project-feature-auth       â”‚ feature/authâ”‚ e4f5g6h          â”‚
â”‚ /project-bugfix-login       â”‚ bugfix/loginâ”‚ i7j8k9l          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¨­å®šé …ç›®

| é …ç›® | å‹ | å¿…é ˆ | èª¬æ˜ |
|------|------|------|------|
| `base_branch` | string | â—‹ | ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒå |
| `docker_compose_file` | string | â—‹ | Docker Composeãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ |
| `copy_files` | string[] | - | ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª |
| `start_command` | string | - | worktreeä½œæˆå¾Œã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ |
| `end_command` | string | - | worktreeå‰Šé™¤æ™‚ã«å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ |
| `env.file` | string[] | - | ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆ |
| `env.adjust` | object | - | ç’°å¢ƒå¤‰æ•°ã®èª¿æ•´è¨­å®š |

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
src/
â”œâ”€â”€ types/           # å‹å®šç¾©
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ constants/       # å®šæ•°å®šç¾©
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ core/            # ã‚³ã‚¢ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ config/      # è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ git/         # Gitæ“ä½œ
â”‚   â”œâ”€â”€ docker/      # Dockeræ“ä½œ
â”‚   â””â”€â”€ environment/ # ç’°å¢ƒå¤‰æ•°å‡¦ç†
â”œâ”€â”€ cli/             # CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ commands/    # ã‚³ãƒãƒ³ãƒ‰å®Ÿè£…
â”‚   â”‚   â”œâ”€â”€ create.ts
â”‚   â”‚   â”œâ”€â”€ remove.ts
â”‚   â”‚   â””â”€â”€ status.ts
â”‚   â””â”€â”€ index.ts     # CLIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â””â”€â”€ index.ts         # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
```

## é–‹ç™º

### å¿…è¦ãªç’°å¢ƒ

- Node.js 18.0.0ä»¥ä¸Š
- Docker
- Git

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ãƒ“ãƒ«ãƒ‰
npm run build

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# å‹ãƒã‚§ãƒƒã‚¯
npm run typecheck

# ãƒªãƒ³ãƒˆãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
npm run check
```

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ãƒ†ã‚¹ãƒˆ

```bash
cd sample
../dist/index.js create feature/test
../dist/index.js status
../dist/index.js remove feature/test
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
